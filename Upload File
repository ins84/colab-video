# ============================================
# CELLA 1: Upload File Excel (qualsiasi nome)
# ============================================

from google.colab import files
from pathlib import Path
import shutil

print("üì§ CARICA IL TUO FILE EXCEL")
print("="*60)
print("Pu√≤ avere qualsiasi nome (es: video.xlsx, prompts.xlsx, etc.)")
print("Struttura richiesta:")
print("  ‚Ä¢ Colonna 'Prompt' ‚Üí Testo del prompt")
print("  ‚Ä¢ Colonna 'NomeFile' ‚Üí Nome video (senza .mp4)")
print("="*60)
print()

uploaded = files.upload()

if not uploaded:
    print("‚ùå Nessun file caricato!")
else:
    # Prendi il primo file caricato
    filename = list(uploaded.keys())[0]

    # Verifica che sia un Excel
    if not (filename.endswith('.xlsx') or filename.endswith('.xls')):
        print(f"‚ùå File '{filename}' non √® un Excel!")
        print("   Carica un file .xlsx o .xls")
    else:
        # Rinomina in prompts.xlsx per compatibilit√† con script
        if filename != 'prompts.xlsx':
            shutil.copy(filename, 'prompts.xlsx')
            print(f"‚úÖ File '{filename}' caricato e rinominato in 'prompts.xlsx'")
        else:
            print(f"‚úÖ File '{filename}' caricato!")

        # Mostra preview
        import pandas as pd
        try:
            df = pd.read_excel('prompts.xlsx')
            total = len(df)
            print(f"\nüìä CONTENUTO FILE:")
            print(f"   ‚Ä¢ Righe totali: {total}")

            if 'Prompt' in df.columns and 'NomeFile' in df.columns:
                print(f"   ‚Ä¢ Colonne trovate: ‚úÖ Prompt, ‚úÖ NomeFile")
                print(f"\nüìã PREVIEW (primi 3):")
                for i, row in df.head(3).iterrows():
                    prompt_preview = str(row['Prompt'])[:50]
                    if len(str(row['Prompt'])) > 50:
                        prompt_preview += "..."
                    print(f"   {i+1}. {row['NomeFile']}")
                    print(f"      ‚Üí {prompt_preview}")
                if total > 3:
                    print(f"   ... e altri {total-3} prompt")
            else:
                print(f"   ‚ö†Ô∏è ATTENZIONE: Colonne non corrette!")
                print(f"   Colonne trovate: {', '.join(df.columns)}")
                print(f"   Colonne richieste: 'Prompt', 'NomeFile'")
        except Exception as e:
            print(f"‚ö†Ô∏è Errore lettura file: {e}")

        print("\n" + "="*60)
        print("‚úÖ PRONTO! Ora puoi eseguire:")
        print("   ‚Ä¢ CELLA 3 ‚Üí Login (solo prima volta)")
        print("   ‚Ä¢ CELLA 4 ‚Üí Genera video")
        print("="*60)

